!function(){"use strict";function a(a,b,d,e,f){d.state("home",{url:"/app",templateUrl:"/views/home.html",controller:"homeCtrl",controllerAs:"home"}).state("about",{url:"/app/about",templateUrl:"/views/about.html",controller:"aboutCtrl",controllerAs:"about"}).state("deals",{url:"/app/deals",abstract:!0,templateUrl:"/views/deals.html",controller:"getAllDealsCtrl",controllerAs:"deal",resolve:{loginRequired:c}}).state("deals.cards",{url:"",templateUrl:"/views/deals-cards.html",controller:"getAllDealsCtrl",controllerAs:"deal"}).state("deals.lists",{url:"/app/deals/lists",templateUrl:"/views/deals-lists.html",controller:"getAllDealsCtrl",controllerAs:"deal"}).state("detailedDeal",{url:"/app/deal/:id",templateUrl:"/views/deal-detailed-view.html",controller:"detailedDealCtrl",controllerAs:"detailedDeal"}).state("faq",{url:"/app/faq",templateUrl:"/views/faq.html",controller:"faqCtrl",controllerAs:"faq"}).state("login",{url:"/app/login",templateUrl:"/views/login.html",controller:"loginCtrl"}).state("dashboard",{url:"/app/dashboard",templateUrl:"/views/dashboard.html",controller:"dashboardCtrl"}).state("signup",{url:"/app/signup",templateUrl:"/views/signup.html",controller:"signupCtrl"}),e.otherwise("/app"),a.defaults.headers.common["X-Requested-With"]="XMLHttpRequest",b.html5Mode(!0),f.loginUrl="/api/auth/login",f.signupUrl="/api/auth/signup",f.oauth2({name:"instagram",url:"http://localhost:8080/api/auth/instagram",redirectUri:window.location.origin,clientId:"e184998431cd44aa9af937b7e37ecbb9",requiredUrlParams:["scope"],scope:["likes"],scopeDelimiter:"+",authorizationEndpoint:"https://api.instagram.com/oauth/authorize"})}function b(a,b,c){c.isAuthenticated()&&(a.currentUser=JSON.parse(b.localStorage.currentUser))}function c(a,b,c){var d=a.defer();return c.isAuthenticated()?d.resolve():b.path("app/login"),d.promise}a.$inject=["$httpProvider","$locationProvider","$stateProvider","$urlRouterProvider","$authProvider"],b.$inject=["$rootScope","$window","$auth"],c.$inject=["$q","$location","$auth"],angular.module("gnom-app",["ui.router","ngMessages","ngStorage","ngAnimate","satellizer","ui.bootstrap"]).config(a).run(b)}(),function(){function a(){}a.$inject=["aboutService"],angular.module("gnom-app").controller("aboutCtrl",a)}(),function(){function a(){var a=this;a.animationsEnabled=!0,a.open=function(b,c){var d=c?angular.element($document[0].querySelectro(".flexbox-parent")):void 0,e=$uibModal.open({animation:$ctrl.animationsEnabled,ariaLabelledBy:"modal-title",ariaDescribedBy:"modal-body",templateUrl:"add-deal.html",controller:"addDealCtrl",controllerAs:"addDeal",size:b,appendTo:d,resolve:{items:function(){return $ctrl.items}}});e.result.then(function(b){a.selected=b},function(){console.log("Modal dismissed at: "+new Date)})}}angular.module("gnom-app").controller("dashboardCtrl",a)}(),function(){function a(a,b){function c(){return d().then(function(){})}function d(){return a.getAllDeals().then(e)}function e(a){return f.allDeals=a,f.allDeals}var f=this;f.allDeals=[],f.$state=b,c()}a.$inject=["getAllDealsService","$state"],angular.module("gnom-app").controller("getAllDealsCtrl",a)}(),function(){function a(a,b){function c(){return d().then(function(){})}function d(){return a.getDeal(b.id).then(e)}function e(a){return f.detailedDeal=a,f.detailedDeal}var f=this;f.detailedDeal=[],c()}a.$inject=["getDealService","$stateParams"],angular.module("gnom-app").controller("detailedDealCtrl",a)}(),function(){function a(){var a=this;a.pageClass="page-faq"}angular.module("gnom-app").controller("faqCtrl",a)}(),function(){function a(a,b,c,d){b.isAuthenticated=function(){return d.isAuthenticated()},b.linkInstagram=function(){d.link("instagram").then(function(b){a.localStorage.currentUser=JSON.stringify(b.data.user),c.currentUser=JSON.parse(a.localStorage.currentUser)})}}a.$inject=["$window","$scope","$rootScope","$auth"],angular.module("gnom-app").controller("homeCtrl",a)}(),function(){function a(a,b,c,d,e,f){b.instagramLogin=function(){e.authenticate("instagram").then(function(b){a.localStorage.currentUser=JSON.stringify(b.data.user),d.currentUser=JSON.parse(a.localStorage.currentUser),c.path("/")}).catch(function(a){console.log(a.data)})},b.emailLogin=function(){e.login({email:b.email,password:b.password}).then(function(b){console.log(JSON.stringify(b.data)),a.localStorage.currentUser=JSON.stringify(b.data.user),d.currentUser=JSON.parse(a.localStorage.currentUser),c.path("/")}).catch(function(a){b.errorMessage={},angular.forEach(a.data.message,function(c,d){b.loginForm[d].$setValidity("server",!1),b.errorMessage[d]=a.data.message[d]})})}}a.$inject=["$window","$scope","$location","$rootScope","$auth","userService"],angular.module("gnom-app").controller("loginCtrl",a)}(),function(){function a(a,b,c,d){function e(){d.logout(),delete b.localStorage.currentUser,a.path("/")}function f(){return d.isAuthenticated()}function g(b){a.path(b)}c.logout=e,c.go=g,c.isAuthenticated=f}a.$inject=["$location","$window","$scope","$auth","$state"],angular.module("gnom-app").controller("navCtrl",a)}(),function(){function a(a,b,c,d,e,f){a.localSignup=function(){console.log("Signing up!");var g={method:"POST",url:"/api/auth/signup",data:{email:a.email,password:a.password}};c(g).then(function(a){console.log(JSON.stringify(a.data)),console.log(JSON.stringify(a.data.token)),f.setToken(a.data.token),d.localStorage.currentUser=JSON.stringify(a.data.user),e.currentUser=JSON.parse(d.localStorage.currentUser),b.path("/")},function(a){console.log(a.data)})}}a.$inject=["$scope","$location","$http","$window","$rootScope","$auth"],angular.module("gnom-app").controller("signupCtrl",a)}(),angular.module("gnom-app").directive("activeLink",["$location",function(a){return{restrict:"A",replace:!1,link:function(b,c){b.$on("$stateChangeSuccess",function(){var b=[a.path()];angular.forEach(c.find("a"),function(a){a=angular.element(a),-1!==b[0].indexOf(a.attr("href").substring(5))&&a.attr("href").length>4||b[0]===a.attr("href")?a.parent().addClass("active"):a.parent().removeClass("active")})})}}}]),function(){function a(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){b.on("keydown",function(){d.$setValidity("server",!0)})}}}angular.module("gnom-app").directive("serverError",a)}(),angular.module("gnom-app").directive("usernameExists",["$http",function(a){return{require:"ngModel",link:function(b,c,d,e){e.$asyncValidators.usernameExists=function(b){return a.get("/user/checkUsernameExists/"+e.username).then(function(a){return console.log("Username: "+b),a.data===!0})}}}}]),function(){function a(a){}a.$inject=["$http"],angular.module("gnom-app").service("aboutService",a)}(),function(){function a(a){function b(b){return a.post("/api/order",b).then(c).catch(d)}function c(a){return a.data}function d(a){console.log("checkoutFailed: "+a)}return{checkout:b}}a.$inject=["$http"],angular.module("gnom-app").factory("checkoutService",a)}(),function(){function a(a){function b(){return a.get("/api/deal/all").then(c).catch(d)}function c(a){return a.data}function d(a){console.log("getAllDealsFailed: "+a)}return{getAllDeals:b}}a.$inject=["$http"],angular.module("gnom-app").factory("getAllDealsService",a)}(),function(){function a(a){function b(b){return console.log("getDealService: "+b),a.get("/api/deal/"+b).then(c).catch(d)}function c(a){return console.log("getDealComplete: "),console.log(a.data),a.data}function d(a){console.log("getDealFailed: "+a)}return{getDeal:b}}a.$inject=["$http"],angular.module("gnom-app").factory("getDealService",a)}(),function(){function a(a){}a.$inject=["$http"],angular.module("gnom-app").service("homeService",a)}(),function(){"use strict";function a(a,b,c){function d(d,e,f){var g={username:d,password:e};console.log(g),a.post("api/auth/login",g).then(function(d){if(d.data.token){var e={username:g.username,token:d.data.token};b.currentUser=e,console.log(b.currentUser),a.defaults.headers.common.Authorization="Bearer "+d.data.token,c.currentUserSignedIn=!0,f(!0)}else f(!1)})}function e(){delete b.currentUser,a.defaults.headers.common.Authorization="",c.currentUserSignedIn=!1,console.log("User logged out in service too"),console.log(c.currentUserSignedIn)}var f={};return f.login=d,f.logout=e,f}a.$inject=["$http","$localStorage","$rootScope"],angular.module("gnom-app").service("userService",a)}();